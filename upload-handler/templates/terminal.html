<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://unpkg.com/xterm/css/xterm.css"/>
        <<script src="https://unpkg.com/xterm"></script>
        <script src="https://unpkg.com/xterm-addon-fit"></script>
        <script src="https://unpkg.com/xterm-addon-webgl"></script>
    </head>
    <body>
        <div id="terminal"></div>
        <script>
            const terminal = new Terminal();
            const webglAddon = new WebglAddon.WebglAddon();
            const fitAddon = new FitAddon.FitAddon();
            terminal.loadAddon(webglAddon);
            terminal.loadAddon(fitAddon);
            fitAddon.fit();
            
            function sendCommand(command) {
                fetch('/send-command', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ command: command })
                })
                .then(response => response.json())
                .then(data => {
                    terminal.writeln(data.output);
                })
                .catch(error => {
                    console.error('Failed to send command:', error);
                });
            }
            
            terminal.onData(data => {
                sendCommand(data);
            });
        </script>
    </body>
</html>